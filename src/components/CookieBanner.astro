---
import Button from "./Button.astro"
---

<div id="cookie-banner" class="fixed bottom-0 left-0 right-0 bg-[var(--color-foreground)] text-[var(--color-background)] p-4 shadow-lg z-50 hidden">
  <div class="max-w-4xl mx-auto flex flex-col sm:flex-row 
  items-center sm:items-center 
  justify-center sm:justify-between 
  gap-4">    <p class="text-sm flex-1">
      Este sitio web utiliza cookies propias y de terceros para mejorar tu experiencia de navegaci칩n y analizar el tr치fico.
      <button data-open-dialog="cookies" class="underline ml-2">M치s informaci칩n</button>
    </p>
     
    <div class="flex flex-col sm:flex-row gap-2 mt-4 sm:mt-0 w-full sm:w-auto">
      
      <Button
        label="Aceptar todas"
        id="accept-all-cookies"
      />

      <Button
        label="Solo necesarias"
        id="accept-essential"
        variant="outlinedInverted"
      />

      <Button
        label="Configurar"
        id="configure-cookies"
        data-open-dialog="cookie-config"
        variant="outlinedInverted"
      />
        
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const banner = document.getElementById("cookie-banner");
    const acceptAllBtn = document.getElementById("accept-all-cookies");
    const acceptEssentialBtn = document.getElementById("accept-essential");

    // Check if consent already given
    const consent = localStorage.getItem("cookieConsent");
    if (!consent) {
      banner.classList.remove("hidden");
    } else {
      // If already consented, hide banner
      banner.classList.add("hidden");
    }

    acceptAllBtn.addEventListener("click", () => {
      localStorage.setItem("cookieConsent", JSON.stringify({
        necessary: true,
        analytics: true
      }));
      banner.classList.add("hidden");
      // Enable all cookies
    });

    acceptEssentialBtn.addEventListener("click", () => {
      localStorage.setItem("cookieConsent", JSON.stringify({
        necessary: true,
        analytics: false
      }));
      banner.classList.add("hidden");
      // Enable only necessary cookies
    });

    // Configure button opens the cookies dialog, handled by existing script
  });
</script>